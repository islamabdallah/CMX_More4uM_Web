@model MoreForYou.Services.Models.API.Medical.MedicalRequestDetailsModel

@{
    ViewData["Title"] = "Home";
    ViewData["SubTitle"] = "My Benefits";
    ViewData["activ"] = "lmBenefits";
    Layout = "~/Views/Shared/_More4ULayoutDashboard.cshtml";

}
<link href="~/css/newStyleSheet.css" rel="stylesheet" />
<script src="~/js/JQuery/jquery-3.5.1.js"></script>
<script src="~/js/sweetalert.min.js"></script>

@if (Model != null)
{
    <div class="row">
        <div class="col-lg-6" id="myBenefits">
            @* style="height: 800px; overflow-y:scroll" *@
            <div class="col-xl-12">
                @*  style="max-height: 35rem; overflow-y: auto; background-attachment: local, local, scroll, scroll;"> *@
              
                  
                        <div class="col-lg-12 mb-lg-0 mb-4 mt-3" id="">
                            <div class="card">
                                <div class="card-body p-3">
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="d-flex flex-column h-100">
                                                <p class="mb-1 pt-2 text-bold">Benefit Request</p>
                                        <h5 class="font-weight-bolder text-gradient text-primary">@Model.MedicalRequest.requestType</h5>
                                                <hr class="horizontal dark my-sm-4">
                                                <p class="mb-5">
                                                    Total Requests :
                                            @if (Model.MedicalRequest.requestType == 1)
                                            {
                                                <span class="badge badge-sm bg-gradient-info pr-5">@Model.MedicalRequest.requestType</span>
                                            }
                                            else if (Model.MedicalRequest.requestType==2)
                                                                    {
                                                <span class="badge badge-sm bg-gradient-success pr-5">@Model.MedicalRequest.requestType</span>
                                            }
                                            else if (Model.MedicalRequest.requestType==3)
                                            {
                                                <span class="badge badge-sm bg-gradient-danger pr-5">@Model.MedicalRequest.requestType</span>
                                            }
                                                    <br />Approved Requests : 
                                                    <br />Last Request Status:
                                                                                                   
                                                </p>
                                                                                         
                                                <a class="text-body text-sm font-weight-bold mb-0 icon-move-right mt-auto" href="#">
                                                    Details
                                                    <i class="fas fa-arrow-right text-sm ms-1" aria-hidden="true"></i>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 ms-auto text-center mt-5 mt-lg-0">
                                            <div class="bg-gradient-primary border-radius-lg h-100">
                                                      <div class="position-relative d-flex h-100">
                                                    <img class="w-100 position-relative z-index-2 border-radius-lg p-1" src="" alt="rocket">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                 
            </div>
        </div>
        <div class="col-lg-6 mt-3">
            <div class="card mb-4" style="height:fit-content">
                <div class="card-header pb-0 px-3">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="mb-0" id="title">Benefits Request History</h6>
                        </div>
                        <div class="col-md-6 d-flex justify-content-end align-items-center">
                            <i class="fa fa-repeat me-2"></i>
                            <small id="RequestsCount"></small>
                        </div>
                    </div>
                </div>
                <div class="card-header pb-0 px-3">
                    <div class="row">
                        <div class="col-md-6">
                            <h5 class="font-weight-bolder text-gradient text-primary" id="lmtitle"></h5>
                            <hr class="horizontal dark my-sm-4">
                        </div>
                    </div>
                </div>
                <div class="card-body pt-4 p-3" id="requestsCard">

                    <div class="row">
                        <div class="card p-3">
                            <div class="col-lg-8 my-auto">
                                @* <h5>please select one of the benefits from the left side to check the request history details </h5> *@
                                <p class="lead"><span class="font-weight-normal text-gradient text-primary">Please select one of the benefits from the left side to check the request history details</span></p>
                                <a type="button" class="btn bg-gradient-dark mt-4" asp-controller="Benefit" asp-action="ShowBenefits">Go to Dashboard</a>
                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="card p-4">
        <div class="card-body p-3">
            <div class="row">
                <div class="card p-3">
                    <div class="col-lg-8 my-auto">
                        <h5>You have no Benefits Requests  </h5>
                        <p class="lead">
                            <span class="font-weight-normal text-gradient text-primary">
                                My Benefits contains all the benefits requests/ history that you have made. Following request details /status (acceptance, rejection, and comments).
                            </span>
                        </p>
                        <a type="button" class="btn bg-gradient-dark mt-4" asp-controller="Benefit" asp-action="ShowBenefits">Go to Dashboard</a>
                    </div>
                    @*         <div class="col-lg-6 my-auto position-relative">
                <img class="w-100 position-relative" src="~/softui/assets/img/illustrations/error-404.png" alt="404-error">
                </div> *@
                </div>
            </div>
        </div>
    </div>
}
<script src="~/js/mybenefitsjs.js"></script>
<script src="~/SoftUI/assets/js/plugins/perfect-scrollbar.min.js"></script>
<script src="~/SoftUI/assets/js/plugins/smooth-scrollbar.min.js"></script>
<script>
    function getBenefitDetails(id) {
        $(".TimeInfo").remove();
        var tboby = $('#carss');// tbody'
        tboby.empty(); //clear the data
        var url = '@Url.Content("~/")' + "more4u/Benefit/getBenefitDetails";
        $.getJSON(url, { id: id }, function (result) {
            if (result != null) {

                document.getElementById("hlm").innerHTML = result.Name;

                var urlPart = result.BenefitCard;
                var rId = result.Id;
                document.getElementById("idlm").value = rId;
                var url2 = '@Url.Content("~/")' + "images/BenefitCards/";
                document.getElementById("imlm").src = url2 + result["BenefitCard"];
                //document.getElementById("imlm").src = "~/images/BenefitCards/" + result["BenefitCard"];
                //document.getElementById('imlm').src = "D:/More4U/More4UAzure/MoreForeYou/wwwroot/images/BenefitCards/CemexAssiutPaternityLeave.png";// + result["BenefitCard"];
                if (result.UserCanRedeem == true) {
                    document.getElementById("dlmm").hidden = true;
                    document.getElementById("dlm").hidden = false;
                }
                else {
                    document.getElementById("dlm").hidden = true;// <a class="btn btn-primary disabled" value = "@TempData asp - action="Redeem" asp - route - id="@TempData" > Redeem < /a>
                    document.getElementById("dlmm").hidden = false;
                }
                // $('#profile-overview').e;
                var divv = document.getElementById("profile-overview");
                divv.innerHTML = "";


                for (let i = 0; i < result.BenefitDecriptionList.length; i++) {
                    //console.log(result.BenefitDecriptionList[i]);
                    var p = document.createElement("p"); //create the paragraph tag
                    p.innerHTML = result.BenefitDecriptionList[i]; // add html text or make another element if needed.

                    // divv.innerHTML=p;
                    divv.appendChild(p);
                }
                //  document.getElementById("profile-overview").innerHTML = content;

                var divv2 = document.getElementById("profile-lm");
                divv2.innerHTML = "";
                if (result.BenefitWorkflows.length != 0) {

                    for (let index2 = 1; index2 <= result.BenefitWorkflows.length; index2++) {
                        //console.log(result.BenefitWorkflows[index2 - 1]);
    @* var p2=`<div class="timeline-block timeline-block-right">
                            <div class="marker active">index2</div>
                            <div class="timeline-content">
                            <h3>${result.BenefitWorkflows[index2 - 1]}</h3>
                            </div>
                            </div>`;*@

                            var label = document.createElement("div");
                        // label.innerHTML = 'Hello World';
                        label.className += "timeline-block timeline-block-right";

                        var label2 = document.createElement("div");
                        label2.innerHTML = index2;
                        label2.className += "marker active";


                        var label3 = document.createElement("div");
                        //label3.innerHTML = index2;
                        label3.className += "timeline-content";


                        var label4 = document.createElement("h3");
                        label4.innerHTML = result.BenefitWorkflows[index2 - 1];
                        // label4.style.textAlign = "center";
                        label3.append(label4);
                        label.appendChild(label2);
                        label.appendChild(label3);
                        divv2.appendChild(label);
                        //divv2.appendChild(p2);

                    }

                }
                else {
                    var label5 = document.createElement("div");
                    //label5.innerHTML = "No APProval Needeed";
                    label5.innerHTML = "No Approval Needed";
                    label5.style.textAlign = "center";

                    divv2.appendChild(label5);
                }



    @* foreach (var condition in result.BenefitConditions)
                    {*@
                    $('#td-lm').empty();

                var tr = "";
    @* for (var key in result.BenefitConditions)
                    {
                    console.log(result.BenefitConditions[key]);
                    console.log(result.BenefitApplicable[key]);

                    }*@
                    $.each(result.BenefitConditions, function (index, condition) {
                        // console.log(condition);
                        var key = index;
                        console.log(key);
                        console.log(result.BenefitApplicable[key]);
                        tr = document.createElement("tr");
                        var td = "";
                        var td2 = "";

                        tr.className += "col-lg-8";
                        if (key == "Type") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-person-fill" style="margin-left: 5px; margin-left: 5px; margin-top: 0px; float: left"></i></span>' + condition;
                        }
                        else if (key == "WorkDuration") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-bar-chart-line-fill" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        else if (key == "DateToMatch") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-calendar-check" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        else if (key == "Age") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-clock-history" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        else if (key == "Gender") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-gender-ambiguous" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        else if (key == "MaritalStatus") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-heart" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        else if (key == "PayrollArea") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bx bx-id-card" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        else if (key == "MaxParticipant") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-door-closed-fill" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + 'Max Participants:-' + condition;
                        }
                        else if (key == "MinParticipant") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-door-open-fill" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + 'Min Participants:-' + condition;
                        }
                        else if (key == "RequiredDocuments") {
                            td = document.createElement("td");
                            td.innerHTML = '<span><i class="bi bi-images" style="margin-left: 5px; margin-right: 5px; float: left"></i></span>' + condition;
                        }
                        tr.append(td);
                        //$('#td-lm').append(tr);

                        td2 = document.createElement("td");
                        //td.innerHTML=condition +'<i class="bi bi-person-fill" style="margin-left: 5px; margin-right: 5px; float: left"></i>';


                        if (key != "RequiredDocuments") {
                            if (result.BenefitApplicable[key] == true) {
                                td2.innerHTML = '<i class="bi bi-check-lg" style="float: right; margin-right: 5px; color:forestgreen; font-size:x-large"></i>';
                            }
                            else {
                                td2.innerHTML = '<i class="bi bi-x" style="float: right; margin-right: 5px; color: red; font-size: x-large"></i>';
                            }
                        }
                        else {
                            td2.innerHTML = '<i class="bi bi-file-earmark-arrow-up" style="float: right; margin-right: 5px; color: dodgerblue; font-size: x-large"></i>';
                        }

                        tr.append(td2);
                        $('#td-lm').append(tr);
                    });


                $('#Benefit-Detailes').modal('show');

            }

        });


    }

</script>

<script>

    function disp(id) {
        var url2 = '@Url.Content("~/")' + "images/BenefitCards/";
        console.log(this.src);
        var r = document.getElementById("lmimg+" + id).src;
        var n = document.getElementById("nam+" + id).value;
        console.log(r);
        console.log(n);
        document.getElementById("imtitle").innerHTML = n;
        document.getElementById("myimg").src = r;//url2 + id;
        $('#display').modal('show');
    }

</script>

<script>

    function hideimg() {

        console.log("done");
        $('#display').modal('hide');
    }

</script>

<script>

    function Redem() {
        var id = document.getElementById("idlm").value;
        $('#Benefit-Detailes').modal('toggle');
        var url = '@Url.Content("~/")' + "more4u/Benefit/Redeemm";
        $.getJSON(url, { id: id }, function (result) {

            window.location.href = "@Url.RouteUrl(new { Controller = "Benefit", Action = "Redeem" })/?id=" + id
        });
    }

</script>
<script>
    function myFunction(value, items) {
        var val = value;
        console.log(val);
        for (let i = 0; i < items.length; i++) {
            console.log(items.length);
            console.log(items[3].UserName);
            if (items[i].Name == val || val == "") {
                console.log("done");
                document.getElementById(items[i].Id).hidden = false;
                //document.getElementById("lm+" + items[i].RequestNumber).hidden = false;
            }
            else {
                document.getElementById(items[i].Id).hidden = true;
                // document.getElementById("lm+" + items[i].RequestNumber).hidden = true;
            }
        }

    }

</script>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
